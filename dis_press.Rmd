---
title: "Hacia un consenso sobre como cuantificar las enfermedades de cultivos "
author: "Juan Edwards Molina"
date: "`r format(Sys.time(), '%d %B, %Y')`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message = FALSE,
                      warning = FALSE, 
                      fig.path = "dispress_figs")
library(tidyverse)
library(plotly)
```

--- 

La cuantificación de enfermedades de cultivos es la piedra  fundamental de cualquier estudio de fitopatología / epidemiologia. Sin embargo, las métricas utilizadas para ello han sido y serán de gran discrepancia en la comunidad de fitopatólogos, monitoreadores, asesores y experimentadores. La fitopatometría es la rama de la fitopatología que cuantifica la enfermedad o los patógenos presentes en los diferentes niveles de organización, desde órgano a región.   

Supongamos el siguiente ejemplo: 

![](https://docs.google.com/drawings/d/e/2PACX-1vSG5ML3zt_0_xk-z3H8wb1bH4Vs6Ip1lJHRIPKHC0WvG6NLTJ4KgWtRJe27dgny_FXPnzPss9BQmjAn/pub?w=882&h=279) 

Es ampliamente aceptado que: 

- A nivel de órgano (hoja, fruto, infloresencia, etc., para fines prácticos hablaremos de hojas en esta nota) la **severidad** es el _área de hoja ocupada por lesión de una enfermedad_. 

A nivel de población de hojas (nivel de cultivo): la **incidencia** es el porcentaje (o proporción) de hojas con al menos una lesión de un total "n" de hojas evaluadas (I%), o sea: 

$Incidencia = \frac{hj_e}{n} * 100$


La falta de consenso (o divergencia de adopción) ocurre cuando se habla severidad a nivel de población (o cultivo). 

Según Madden¹, la *severidad media* se obtiene de calcular la media de las severidades individuales de todas las hojas evaluadas (incluyendo las sanas). La severidad media de solo las hojas infectadas, la llama *severidad condicional* ya que solo considera hojas enfermedas. 

En Argentina, existe vriabilidad en la términologia: además de severidad e incidencia es comun oir/leer *intensidad*, *severidad en sentido estricto* (severidad de solo hojas enfermas) y *severidad en sentido amplio* (severidad de todas las hojas evaluadas).

Retomemos el ejemplo expuesto anteriormente. 

La incidencia es fácil de obtener y justamente su gran ventaja es que carece de subjetividad: 

$Incidencia = \frac{4}{10} * 100 = 40\%$

Para estimar la severidad (S%) adoptaremos la "severidad en sentido estricto" (o bien, la "severidad condicional" de Madden 2007), es decir promediamos la severidad de solo hojas enfermas: 

$Severidad = promedio(10,1,5,7) = 5,75\%$ 

Si quisiéramos establecer la "cantidad total" de enfermedad presente en nuestro cultivo, sin dudas debemos complementar la incidencia con la severidad (ambas expresadas en proporcion para obtener un valor de intensidad entre 0-100). Calculamos asi la **intensidad** (o bien la "severidad en sentido amplio", o la "severidad media")

$Intensidad = I * S = (40/100 * 5,75/100)*100 = 2,3 \%$

_(Claramente se podrian simplificar los calculos pero para fines didacticos lo hacemos por extenso)_


Considerar los conceptos de incidencia, severidad e intensidad podria resultar ventajoso ya que puede aportar información acerca de la distribución de la enfermedad en el cultivo: 

```{r}
dat <- tibble(expand.grid(severidad = seq(1, 100, 1), 
                       incidencia = seq(1, 100, 1)) %>% 
  mutate(intensidad = (incidencia/10*severidad/10)))
```

```{r}
# brks_manchas <- c(5, 10, 15, 20, 25)
# library(scales)
dat %>% #filter(incidencia<50 | severidad<50) %>% 
  ggplot(aes(incidencia, severidad, z = intensidad)) + 
  geom_tile(aes(fill = intensidad)) +
  geom_contour(aes(z = intensidad), colour = "grey70")+ # bins = 5
  scale_fill_distiller(palette = "Spectral", direction = -1, 
                       limits = c(-15, 100)) +
  # xlim(0,100)+ ylim(0,100)+
  labs(x="Incidencia", y = "Severidad", 
       title= "Intensidad de enfermedad (%)",
       subtitle = "Intensidad = incidencia * severidad")+
  metR::geom_text_contour(aes(z = intensidad))+
  theme_bw() %+replace% theme(legend.position = "none")+
    geom_point(data = data.frame(severidad = c(20,80), incidencia=c(80,20), intensidad=NA), 
             aes(x=incidencia, y=severidad))+
  geom_text(data = data.frame(severidad = c(80,20), incidencia=c(20,80), intensidad=NA, lab=c("A", "B")),  aes(label=lab, vjust = 0, hjust = -0.5))
```

En este ejemplo ficticio, A (20%I/80%S) y B (80%I/20%S) tienen exactamente la misma intensidad (16%) sin embarrgo representan dos situaciones completamente diferentes a nivel de lote: **A** podria deberse a una enfermedad iniciada en focos (roya estriada o amarilla) y **B** podria representar una enfermedad que se presente en forma generalizada (roya de la hoja o anaranjada)  

Habiendo estalecido las bases conceptuales de las metricas de cuantificación podemos pasar a otro punto fundamental que es establecer qué **presión de enfermedad** tiene un cultivo determinado, información clave para caracterizar años, localidades, situaciones de manejo, y fundamentalmente ensayos.

### Estableciendo la presión de enfermedad de un cultivo

Un punto fundamental, es detallar sobre que porción del canopeo estamos haciendo la estimación, ya que una misma severidad por planta puede tener diferente distribución en el perfil del canopeo, con la potencial diferencia sobre el rendimiento.   

![](https://docs.google.com/drawings/d/e/2PACX-1vSESR-P4u_Gm_j-GxhTwy7R9GUEmBFLIgGATxjOkH_U39ScMT30e5UR_FfaNomyZ5ZxVKsUnn9Fz1SS/pub?w=635&h=306)

En el caso del cultivo de trigo, es conocido que las mayor contribución al rendimiento es aportado por la hoja bandera (HB), luego HB-1, y HB-2. Por esto mismo es podria establecerse estas 3 hojas como target de muestreo. 


**Manchas foliares**

Valores máximos de incidencia pueden rondar en 60% y severidad en 30%

Podria establecerse como umbrales de presión, según nivel de intensidad: 

* Baja: <5% 
* Media: 5 a 10%
* Alta: >10%

(Grafico reactivo: puede cliquear sobre el área del grafico para ver los valores)

```{r}
brks_manchas <- c(5, 10, 15, 20, 25)
# library(scales)
p_manchas <- 
  dat %>% filter(incidencia<50 | severidad<50) %>% 
  ggplot(aes(incidencia, severidad, z = intensidad)) + 
  geom_tile(aes(fill = intensidad)) +
  geom_contour(aes(z = intensidad), breaks = brks_manchas, colour = "grey90")+ # bins = 5
  scale_fill_distiller(palette = "Spectral", direction = -1, 
                       limits = c(-5, 30)) +
  xlim(0,50)+ ylim(0,50)+
  # geom_vline(xintercept = c(20, 40), linetype=2, alpha=0.2)+
  # geom_hline(yintercept = c(20, 40), linetype=2, alpha=0.2)+
  labs(x="Incidencia", y = "Severidad", 
       title= "Intensidad de manchas(%)",
       subtitle = "Intensidad = incidencia * severidad")+
  geom_text(data = data.frame(severidad = seq(10, 40, 10), 
                              incidencia=c(48), 
                              intensidad=NA, lab=paste(seq(5,20,5), "%")), 
            aes(label=lab, vjust = 0, hjust = 0), angle = -25) +
  theme_bw() %+replace% theme(legend.position = "none")
withr::with_options(list(digits = 1), ggplotly(p_manchas))
```

**Royas** 

Es comun observar mayores niveles de incidencia que en mancha (hasta 100%). 

Podria establecerse como umbrales de presión, según nivel de intensidad: 

* Baja: <5% 
* Media: 5 a 10%
* Alta: >10%

```{r}
# library(scales)
brks_royas <- seq(10,100,10)
p_royas <- 
  dat %>% 
  ggplot(aes(incidencia, severidad, z = intensidad)) + 
  geom_tile(aes(fill = intensidad)) +
  geom_contour(aes(z = intensidad), breaks = brks_royas, colour = "grey90")+ # bins = 5
  scale_fill_distiller(palette = "Spectral", direction = -1, 
                       limits = c(-10, 100)) +
  # geom_vline(xintercept = c(20, 40), linetype=2, alpha=0.2)+
  # geom_hline(yintercept = c(20, 40), linetype=2, alpha=0.2)+
  labs(x="Incidencia", y = "Severidad", 
       title= "Intensidad de roya (%)",
       subtitle = "Intensidad = incidencia * severidad")+
  geom_text(data = data.frame(severidad = seq(10, 100, 10), 
                              incidencia=c(95), 
                              intensidad=NA, lab=paste(seq(10,100,10), "%")), 
            aes(label=lab, vjust = 0, hjust = 0), angle = -25) +
  theme_bw() %+replace% theme(legend.position = "none")

withr::with_options(list(digits = 2), ggplotly(p_royas))
```

---

¹Study of plant disease epidemics (2007), cap 2, pag 12 
